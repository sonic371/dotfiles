#!/bin/bash
# A simple and portable iface script for i3blocks that uses nmcli.

# Find the device that is connected and has the default route.
# If that fails, find the first connected device.
DEVICE=$(nmcli -g DEVICE,STATE d | grep ':connected$' | head -n1 | cut -d: -f1)

if [ -n "$DEVICE" ]; then
    # A connected device was found. Get its IP address.
    IP_ADDRESS=$(nmcli -g IP4.ADDRESS device show "$DEVICE" | sed 's/\/.*//')

    if [ -n "$IP_ADDRESS" ]; then
        # Print an icon and the clean IP address.
        echo "󰩟 $IP_ADDRESS"
    else
        # Connected, but no IPv4 address (e.g., IPv6 only)
        echo "󰩠 Connected"
    fi
else
    # No active connection was found.
    echo "󰩠 Disconnected"
fi
