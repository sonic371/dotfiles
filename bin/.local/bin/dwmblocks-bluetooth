#!/bin/bash
# Get connected Bluetooth device name

# Set default terminal if not defined
TERMINAL="${TERMINAL:-st}"

case "$BLOCK_BUTTON" in
    1) 
        # Define terminal-specific options for window name
        case "$TERMINAL" in
            kitty)
                opts=(--name "bluetui")
                ;;
            st)
                opts=(-n "bluetui")
                ;;
            *)
                opts=()
                ;;
        esac
        $TERMINAL "${opts[@]}" -e bluetui &
        ;;
esac

if bluetoothctl show 2>/dev/null | grep -q "Powered: yes"; then
    device=$(bluetoothctl info 2>/dev/null | awk '/Name:/ {print $2}')
    if [[ -n $device ]]; then
        # Truncate long names
        [[ ${#device} -gt 15 ]] && device="${device:0:12}..."
        echo "󰂯 $device"
    else
        echo "󰂯"
    fi
fi
